<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏Å‡∏±‡∏ö‡∏à‡πâ‡∏ß‡∏î‡∏à‡πâ‡∏≤‡∏î ‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠</title>
  <style>
    body {
      margin: 0;
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(to top, #020d1f, #0e2745);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 16px;
    }
    .container {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 24px;
      max-width: 900px;
      width: 100%;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.6);
    }
    h1 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 8px;
    }
    h2 {
      text-align: center;
      color: #ffc864;
      font-weight: normal;
    }
    label {
      display: block;
      margin-top: 10px;
      margin-bottom: 4px;
    }
    input, select, textarea {
      width: 100%;
      border: none;
      border-radius: 8px;
      padding: 8px;
      font-size: 1rem;
      outline: none;
    }
    button {
      margin-top: 14px;
      background: linear-gradient(90deg, #ffcc33, #ff9933);
      color: #000;
      border: none;
      border-radius: 999px;
      padding: 10px 16px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: bold;
    }
    .water {
      position: relative;
      background: linear-gradient(to top, #013, #025);
      height: 220px;
      border-radius: 12px;
      overflow: hidden;
      margin-top: 20px;
    }
    .moon {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 2rem;
    }
    .krathong {
      position: absolute;
      bottom: 10px;
      font-size: 2rem;
      animation: floatAcross 20s linear forwards, bob 3s ease-in-out infinite;
    }
    @keyframes floatAcross {
      from { left: -60px; }
      to { left: 100%; }
    }
    @keyframes bob {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }
    ul { list-style: none; padding: 0; }
    li {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 6px 10px;
      margin-top: 4px;
    }
    .meta {
      font-size: 0.8rem;
      color: #ccc;
    }
    .info-box {
      background: rgba(0, 0, 0, 0.35);
      border-radius: 12px;
      padding: 12px 16px;
      margin-bottom: 16px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ü™∑ ‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå "‡∏à‡πâ‡∏ß‡∏î‡∏à‡πâ‡∏≤‡∏î ‡∏™‡∏ï‡∏π‡∏î‡∏¥‡πÇ‡∏≠" ü™∑</h1>
    <h2>‡∏Å‡∏±‡∏ö‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ üé§</h2>

    <!-- ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô -->
    <div id="loginSection" class="info-box">
      <div id="loginFormBox">
        <strong>‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</strong>
        <form id="loginForm">
          <label for="loginName">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
          <input id="loginName" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" />
          <button type="submit">‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</button>
        </form>
      </div>

      <div id="loggedInBox" style="display:none;">
        <strong>‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏•‡πâ‡∏ß</strong>
        <p id="loggedInText" class="meta"></p>
        <button id="logoutBtn" type="button">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

    <!-- ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á -->
    <form id="krathongForm">
      <label for="name">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô (‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏î‡πâ)</label>
      <input id="name" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" />

      <label for="wish">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô (‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà)</label>
      <textarea id="wish" rows="3" placeholder="‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏õ‡∏µ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡πÅ‡∏ï‡πà‡∏™‡∏¥‡πà‡∏á‡∏î‡∏µ ‡πÜ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤..."></textarea>

      <label for="artist">‡∏≠‡∏¢‡∏≤‡∏Å‡∏•‡∏≠‡∏¢‡∏Å‡∏±‡∏ö‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢</label>
      <select id="artist">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢ --</option>
        <option>‡πÑ‡∏û‡∏ö‡∏π‡∏•‡∏¢‡πå ‡πÅ‡∏™‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
        <option>‡∏ó‡πä‡∏≠‡∏õ ‡∏û‡∏™‡∏∏‡∏û‡∏±‡∏à‡∏à‡πå</option>
        <option>‡∏™‡∏ï‡∏≤‡∏á‡∏Ñ‡πå ‡∏û‡∏£‡∏ò‡∏¥‡∏î‡∏≤</option>
        <option>‡∏≠‡∏∏‡πã‡∏°‡∏≠‡∏¥‡πã‡∏° ‡∏≠‡∏ò‡∏¥‡∏ä‡∏≤</option>
        <option>‡∏ö‡∏£‡∏≤‡∏ß ‡∏õ‡πâ‡∏≤‡∏¢‡πÅ‡∏î‡∏á</option>
        <option>‡∏Å‡∏±‡∏™‡∏à‡∏±‡∏á ‡∏ò‡∏ô‡∏≤</option>
        <option>‡∏ó‡∏∏‡∏Å‡∏®‡∏¥‡∏•‡∏õ‡∏¥‡∏ô‡πÉ‡∏ô‡∏Ñ‡πà‡∏≤‡∏¢</option>
      </select>

      <label for="emoji">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏£‡∏∞‡∏ó‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</label>
      <select id="emoji">
        <option>ü™∑</option>
        <option>üèÆ</option>
        <option>üå∏ü™∑</option>
        <option>üïØÔ∏èü™∑</option>
        <option>üíñü™∑</option>
        <option>üçÉü™∑</option>
      </select>

      <button type="submit">üí¶ ‡∏Å‡∏î‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á</button>
    </form>

    <div class="water" id="waterArea">
      <div class="moon">üåï</div>
    </div>

    <h3>üìú ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ê‡∏≤‡∏ô‡∏™‡∏°‡∏õ‡∏£‡∏≤‡∏£‡∏ñ‡∏ô‡∏≤</h3>
   
  <script>
    const form = document.getElementById('krathongForm');
    const waterArea = document.getElementById('waterArea');
    const wishesList = document.getElementById('wishesList');
    const participantsCountEl = document.getElementById('participantsCount');

    const loginForm = document.getElementById('loginForm');
    const loginFormBox = document.getElementById('loginFormBox');
    const loggedInBox = document.getElementById('loggedInBox');
    const loggedInText = document.getElementById('loggedInText');
    const logoutBtn = document.getElementById('logoutBtn');
    const nameInput = document.getElementById('name');

    const USER_KEY = 'jj_user';
    const PARTICIPANT_KEY = 'jj_participants';

    function loadCurrentUser() {
      try { return JSON.parse(localStorage.getItem(USER_KEY)) || null; } catch { return null; }
    }
    function saveCurrentUser(user) { localStorage.setItem(USER_KEY, JSON.stringify(user)); }
    function clearCurrentUser() { localStorage.removeItem(USER_KEY); }
    function loadParticipants() {
      try {
        const data = JSON.parse(localStorage.getItem(PARTICIPANT_KEY));
        return Array.isArray(data) ? data : [];
      } catch { return []; }
    }
    function saveParticipants(list) {
      localStorage.setItem(PARTICIPANT_KEY, JSON.stringify(list));
    }
    function updateParticipantsCount() {
      participantsCountEl.textContent = loadParticipants().length;
    }
    function upsertParticipant(name) {
      const list = loadParticipants();
      if (!list.includes(name)) list.push(name);
      saveParticipants(list);
      updateParticipantsCount();
    }

    function applyUserToUI(user) {
      if (!user) {
        loginFormBox.style.display = 'block';
        loggedInBox.style.display = 'none';
        nameInput.value = '';
        return;
      }
      loginFormBox.style.display = 'none';
      loggedInBox.style.display = 'block';
      loggedInText.textContent = `‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${user.name}`;
      nameInput.value = user.name;
    }

    function floatKrathong(emoji) {
      const el = document.createElement('div');
      el.className = 'krathong';
      el.textContent = emoji;
      const bottom = Math.random() * 120 + 10;
      const duration = Math.random() * 10 + 15;
      el.style.bottom = `${bottom}px`;
      el.style.animationDuration = `${duration}s, 3s`;
      waterArea.appendChild(el);
      setTimeout(() => el.remove(), duration * 1000);
    }

    loginForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const loginName = document.getElementById('loginName').value.trim();
      if (!loginName) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô');
      const user = { name: loginName };
      saveCurrentUser(user);
      upsertParticipant(loginName);
      applyUserToUI(user);
    });

    logoutBtn.addEventListener('click', () => {
      clearCurrentUser();
      applyUserToUI(null);
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const user = loadCurrentUser();
      if (!user) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏≠‡∏¢‡∏Å‡∏£‡∏∞‡∏ó‡∏á');
      const name = nameInput.value.trim() || user.name;
      const artist = document.getElementById('artist').value;
      const emoji = document.getElementById('emoji').value;
      floatKrathong(emoji);

      let timeString;
      try { timeString = new Date().toLocaleString('th-TH'); } 
      catch { timeString = new Date().toLocaleString(); }

      const li = document.createElement('li');
      li.innerHTML = `<strong>${emoji} ${name}</strong><br><span class="meta">‡∏•‡∏≠‡∏¢‡∏Å‡∏±‡∏ö: ${artist || '-'} ‚Ä¢ ${timeString}</span>`;
      wishesList.prepend(li);

      upsertParticipant(name);
      document.getElementById('wish').value = '';
    });

    (function init() {
      const user = loadCurrentUser();
      applyUserToUI(user);
      updateParticipantsCount();
      floatKrathong('ü™∑');
    })();
  </script>
</body>
</html>
